{% extends "kladez_app/base.html" %}

{% block content %}
<div class="card">
    <h2>–í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —Ä–∞–±–æ—Ç—ã</h2>
    
    <!-- –ü—Ä–æ—Å—Ç–∞—è —Ñ–æ—Ä–º–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ -->
    <div style="background: #f8f9fa; padding: 1rem; border-radius: 5px; margin-bottom: 1rem;">
        <form method="get" style="display: flex; gap: 1rem; align-items: end;">
            <div>
                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">–°:</label>
                <input type="date" name="date_from" value="{{ request.GET.date_from }}" style="padding: 0.5rem; border: 1px solid #ddd; border-radius: 4px;">
            </div>
            <div>
                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">–ü–æ:</label>
                <input type="date" name="date_to" value="{{ request.GET.date_to }}" style="padding: 0.5rem; border: 1px solid #ddd; border-radius: 4px;">
            </div>
            <div>
                <button type="submit" style="padding: 0.5rem 1rem; background: #3498db; color: white; border: none; border-radius: 4px; cursor: pointer;">–§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å</button>
                <a href="{% url 'kladez_app:completed_works' %}" style="padding: 0.5rem 1rem; background: #95a5a6; color: white; border: none; border-radius: 4px; text-decoration: none; display: inline-block; margin-left: 0.5rem;">–°–±—Ä–æ—Å–∏—Ç—å</a>
            </div>
        </form>
    </div>

    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
    <div style="display: flex; gap: 1rem; margin-bottom: 1rem; flex-wrap: wrap;">
        <div style="background: #e8f5e8; padding: 0.5rem 1rem; border-radius: 4px;">
            <strong>–í—Å–µ–≥–æ —Ä–∞–±–æ—Ç:</strong> {{ total_count }}
        </div>
        <div style="background: #e8f4fd; padding: 0.5rem 1rem; border-radius: 4px;">
            <strong>–û–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å:</strong> {{ total_cost }} ‚ÇΩ
        </div>
    </div>

    <!-- –¢–∞–±–ª–∏—Ü–∞ —Ä–∞–±–æ—Ç -->
    {% if works %}
        <table>
            <thead>
                <tr>
                    <th>–î–∞—Ç–∞</th>
                    <th>–ú–∞—Ä–∫–∞</th>
                    <th>–ú–æ–¥–µ–ª—å</th>
                    <th>–í–∏–¥ —Ä–∞–±–æ—Ç</th>
                    <th>–°—Ç–æ–∏–º–æ—Å—Ç—å</th>
                    <th>–ó–∞–º–µ—Ç–∫–∏</th>
                </tr>
            </thead>
            <tbody>
                {% for work in works %}
                <tr>
                    <td>{{ work.work_date|date:"d.m.Y" }}</td>
                    <td>{{ work.car_brand.name }}</td>
                    <td>{{ work.car_model.name }}</td>
                    <td>
                        <strong>{{ work.repair_type.category.name }}</strong><br>
                        {{ work.repair_type.name }}
                    </td>
                    <td style="font-weight: bold; color: #27ae60;">{{ work.cost }} ‚ÇΩ</td>
                    <td>
                        {% if work.notes %}
                            <span title="{{ work.notes }}">üìù</span>
                        {% endif %}
                        {% if work.parts_used %}
                            <span title="–ó–∞–ø—á–∞—Å—Ç–∏: {{ work.parts_used }}">üîß</span>
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p style="text-align: center; padding: 2rem; color: #7f8c8d;">
            {% if request.GET.date_from or request.GET.date_to %}
                –ù–µ—Ç —Ä–∞–±–æ—Ç –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥
            {% else %}
                –ï—â—ë –Ω–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö —Ä–∞–±–æ—Ç
            {% endif %}
        </p>
    {% endif %}
</div>
{% endblock %}